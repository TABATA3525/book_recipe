<%= javascript_pack_tag 'star_vue' %>

<h1>Posts#edit</h1>
<span>現在ログイン中のユーザー：<%= current_user.name %></span>
<%= form_for(@userBook, url: user_book_path(@userBook)) do |f| %>
    <div>
        <label>タイトル</label><br>
        <%= f.text_field :title, autofocus: true %>
    </div>
    <div>
        <label>著者</label><br>
        <%= f.text_field :author %>
    </div>
    
    <div>
        <label>カテゴリー</label><br>
        <%= f.collection_select :category_ids, Category.all, :id, :category_name, include_blank: "選択して下さい" %>
    </div>

    <div>
        <label>読後感</label><br>
        <div class="after-reading-container">
            <%= f.collection_select :feeling_category_ids, FeelingCategory.where(user_id: @userBook.user_id).or(FeelingCategory.where(user_id: nil)).order(:user_id, :id), :id, :feeling_after_reading, include_blank: "選択して下さい" %>
            <% if @userBook.user_feeling_categories.blank? %>
                <%= hidden_field :user_feeling_categories, :stars, id: "star_value", value: 1 %>
            <% else %>
                <%= hidden_field :user_feeling_categories, :stars, id: "star_value", value: @userBook.user_feeling_categories&.first&.stars %>
            <% end %>
            <div id="star_input"></div>
        </div>
    </div>
    
    <div>
        <%= text_field :user_book, :feeling_after_reading %>
    </div>
    
    <div>
        <label>感想</label><br>
        <%= f.text_area :feeling %>
    </div>
    
    <div><%= f.submit "更新する" %></div>
    
    <div>
        <%= link_to("戻る", user_books_path) %>
    </div>
<% end %>
